# مدیریت ماژول‌های کرنل در لینوکس

## نمایش ماژول‌های بارگذاری شده با `lsmod`
دستور `lsmod` در لینوکس برای نمایش لیست ماژول‌های بارگذاری شده در کرنل (Kernel) استفاده می‌شود. ماژول‌های کرنل در واقع بخش‌هایی از کد هستند که می‌توانند به صورت دینامیک به کرنل اضافه یا از آن حذف شوند، بدون اینکه نیاز به بازنشانی (Reboot) سیستم باشد.

### نحوه استفاده از `lsmod`
وقتی دستور `lsmod` را در ترمینال اجرا می‌کنید، خروجی شامل سه ستون اصلی است:

1. **Module**: نام ماژول بارگذاری شده.
2. **Size**: اندازه ماژول در حافظه (بر حسب بایت).
3. **Used by**: تعداد دفعاتی که ماژول توسط دیگر ماژول‌ها یا اجزاء سیستم استفاده می‌شود.

### مثال
فرض کنید دستور زیر را اجرا کنید:
```bash
lsmod
```
خروجی ممکن است به صورت زیر باشد:

```vbnet
Module                  Size  Used by
xt_CHECKSUM            16384  1
ipt_MASQUERADE         16384  3
nf_nat_masquerade_ipv4 16384  1 ipt_MASQUERADE
tun                    36864  1
```

در اینجا، ستون "Module" نام ماژول‌ها را نشان می‌دهد، ستون "Size" اندازه هر ماژول را بر حسب بایت نشان می‌دهد، و ستون "Used by" تعداد دفعاتی که ماژول توسط دیگر ماژول‌ها یا اجزاء سیستم استفاده می‌شود را مشخص می‌کند.


### نکات اضافی
ماژول‌های کرنل معمولا برای افزودن قابلیت‌های جدید به سیستم بدون نیاز به تغییر کل کرنل استفاده می‌شوند.

برای بارگذاری یک ماژول جدید می‌توانید از دستور modprobe استفاده کنید، و برای حذف آن از دستور rmmod.

استفاده از lsmod می‌تواند به مدیران سیستم کمک کند تا بررسی کنند چه ماژول‌هایی در حال حاضر فعال هستند و در صورت نیاز به اشکال‌زدایی یا بهینه‌سازی سیستم، اطلاعات مفیدی را در اختیارشان قرار دهد.

## اضافه کردن و حذف ماژول‌های کرنل

### اضافه کردن یک ماژول با modprobe


دستور modprobe برای بارگذاری یک ماژول کرنل استفاده می‌شود. این دستور به صورت خودکار تمام وابستگی‌های ماژول مورد نظر را نیز بارگذاری می‌کند.

مثال:

فرض کنید می‌خواهید ماژولی به نام dummy را که برای ایجاد اینترفیس‌های شبکه مجازی استفاده می‌شود، بارگذاری کنید:

```bash
sudo modprobe dummy
```
این دستور ماژول dummy را از کرنل حذف می‌کند.


### نکات مهم:

دسترسی ریشه (Root Access): برای بارگذاری یا حذف ماژول‌ها نیاز به دسترسی ریشه (سوپر یوزر) دارید، بنابراین باید دستورات را با sudo اجرا کنید.

وابستگی‌ها: دستور modprobe به صورت خودکار وابستگی‌های ماژول را نیز بارگذاری می‌کند، اما دستور rmmod این کار را نمی‌کند. در صورتی که ماژولی دارای وابستگی‌های دیگر است و به آنها نیاز دارد، ابتدا باید این وابستگی‌ها حذف شوند.

استفاده از lsmod: برای بررسی وضعیت ماژول‌ها می‌توانید از lsmod استفاده کنید تا ببینید کدام ماژول‌ها بارگذاری شده‌اند و چند بار استفاده می‌شوند.

این دستورات ابزارهای مهمی در مدیریت کرنل لینوکس هستند و در بهینه‌سازی و پیکربندی سیستم نقش کلیدی دارند.







